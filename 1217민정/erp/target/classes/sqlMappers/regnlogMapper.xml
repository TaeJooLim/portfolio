<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="regnlog">
	<insert id="setEmpOne" parameterType="employeevo">
		<selectKey keyProperty="ref" order="BEFORE" resultType="int">
			SELECT IFNULL( max(emp_id) + 1 , 1 ) FROM employee
		</selectKey>
		INSERT INTO employee SET
			emp_department = #{empDepartment},
			emp_position = #{empPosition},
			emp_num = CONCAT(#{empNum},#{ref}),
			emp_enter = #{empEnter},
			emp_name = #{empName},
			emp_birth = #{empBirth},
			emp_password = #{empPassword},
			emp_email = #{empEmail},
			emp_regdate = now()
	</insert>



	<select id="getLoginChkCnt" parameterType="hashmap" resultType="employeevo">
		select emp_id AS empId, emp_confirm AS empConfirm FROM employee WHERE emp_num = #{empNum} AND emp_password = #{empPassword};
	</select>
	<select id="getLoginConfirm" parameterType="hashmap" resultType="int">
		SELECT COUNT(*) FROM employee WHERE emp_id=#{empId} AND emp_confirm='N'
	</select>

	<select id="getDepartmentList" resultType="employeevo">
		SELECT depart_code AS empDepartment, depart_name AS empDepartmentName FROM department
	</select>
	<select id="getPositionList" resultType="employeevo">
		SELECT position_code AS empPosition, position_name AS empPositionName FROM position
	</select>

</mapper>